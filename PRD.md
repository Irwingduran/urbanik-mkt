# Product Requirements Document (PRD)
## Regen Marketplace - Sustainable E-Commerce Platform

**Versi√≥n:** 1.0
**Fecha:** Octubre 2025
**Autor:** Product Team
**Estado:** En Desarrollo 
---

## 1. Descripci√≥n General del Producto

### Visi√≥n del Producto
Urbanika Marketplace es una plataforma de comercio electr√≥nico sostenible que conecta compradores conscientes con vendedores comprometidos con pr√°cticas regenerativas y sostenible en sus productos. La plataforma no solo facilita transacciones seguras, sino que gamifica la sostenibilidad a trav√©s de un sistema de puntuaci√≥n (Regen Score) en los productos y NFTs evolutivos que es dirigido a los vendedores comprometidos con la sostenibilidad que les permite destacarse por su compromiso, adem√°s de tener acceso a poder certificar sus productos (con nuestro partner certificador y recibir auditorias).
La vision es ser un sistema disruptivo de tal manera en la que se simplifican los procesos tanto para los vendedores como para los consumidores, adem√°s de ser una plataforma moderna, fluida e intuitiva.

### Propuesta de Valor √önica
- **Para Compradores:** Acceso a productos sostenibles verificados, transparencia y control en el impacto ambiental (micro y macro), recompensas y exclusividades por compras conscientes, facilidad al adquirir productos sostenibles.
- **Para Vendedores:** Herramientas profesionales de gesti√≥n de productos, visibilidad en un mercado enfocado en sostenibilidad, sistema de reputaci√≥n basado en impacto (respaldadas por NFT's).
- **Para el Planeta:** Cada transacci√≥n contribuye a un ecosistema m√°s sostenible, medible a trav√©s de m√©tricas de impacto ambiental impulsada por nuestros partners, sellers y compradores.

### Diferenciadores Clave
1. **Sistema de Regen Score:** M√©trica √∫nica que eval√∫a el impacto sostenible de productos y vendedores
2. **NFTs Evolutivos:** Coleccionables digitales que evolucionan seg√∫n el nivel de sostenibilidad alcanzado en los vendedores(respaldada por NFT'S).
3. **Gamificaci√≥n de Sostenibilidad:** Sistema de puntos de lealtad y niveles que incentivan compras conscientes
4. **Transparencia Total:** Dashboards detallados de impacto ambiental para todos los usuarios

---

## 2. Objetivos Comerciales

### Objetivos a corto plazo (Fase 1 - MVP)
| M√©trica | Objetivo | KPI |
|---------|----------|-----|
| Usuarios Activos | 10,000 usuarios registrados | Crecimiento mensual del 40% |
| Transacciones | 10,000 transacciones/mes | Ticket promedio: $500 MXN |
| Vendedores Activos | 500 vendedores verificados | 20+ productos por vendedor |
| Tasa de Conversi√≥n | 3.5% visitante‚Üícomprador | Funnel optimizado |
| Retenci√≥n | 60% usuarios activos mes a mes | Re-compra en 30 d√≠as |
| GMV (Gross Merchandise Value) | $5M MXN/mes | Crecimiento del 25% mensual |

### Objetivos a mediano plazo (Fase 2 - Escalamiento)
- **Usuarios Activos:** 50,000 usuarios
- **Transacciones:** 50,000 transacciones/mes
- **Expansi√≥n Geogr√°fica:** establecerse en el mercado de diversas ciudades.
- **Impacto Sostenible:** 100 toneladas de CO2 evitadas (calculado)

### Objetivos Estrat√©gicos
1. **Market Leadership:** Posicionarse como la plataforma #1 de e-commerce sostenible en M√©xico, simplificando procesos tanto del lado del comprador como del lado del vendedor.
2. **Community Building:** Crear una comunidad y tener un catalogo de miles de usuarios comprometidos con sostenibilidad, se busca que al coexistir todo en una comunidad se logre una mayor colaboraci√≥n y compartici√≥n de conocimientos.
3. **Vendor Ecosystem:** Onboardear 1,000+ vendedores certificados o con aspiraciones a certificaci√≥n en pr√°cticas sostenibles
4. **Revenue Streams:** Diversificar ingresos (comisiones, por certificaciones, publicidad sostenible, suscripciones).

---

## 3. Perfiles de Usuario

### 3.1 Comprador Consciente (USER)

**Demograf√≠a:**
- Edad: 25-45 a√±os
- Nivel socioecon√≥mico: Medio-Alto
- Educaci√≥n: Profesionales y estudiantes universitarios
- Ubicaci√≥n: Zonas urbanas (CDMX, Guadalajara, Monterrey, Puebla)

**Psicograf√≠a:**
- Valores: Sostenibilidad, transparencia, calidad-precio
- Preocupaciones: Cambio clim√°tico, origen de productos, impacto ambiental, impacto regenerativo
- Comportamiento: Investiga antes de comprar

**Necesidades:**
- ‚úÖ Encontrar productos sostenibles verificados f√°cilmente
- ‚úÖ Comprar con confianza (reviews, certificaciones, transparencia)
- ‚úÖ Entender el impacto de sus compras y el impacto que tiene en el planeta
- ‚úÖ Ser recompensado por decisiones conscientes y poder ser parte de la toma de decisi√≥n con los fondos recaudados.
- ‚úÖ Proceso de compra intuitivo, fluido y un pago r√°pido/seguro.

**Pain Points:**
- ‚ùå Dificultad para verificar claims de sostenibilidad
- ‚ùå Productos "verdes" m√°s caros sin justificaci√≥n clara
- ‚ùå Falta de opciones concentradas en un solo lugar
- ‚ùå Falta de comunidad que permita la cooperaci√≥n y colaboraci√≥n
- ‚ùå Desconfianza en procesos de pago online

**User Journey:**
1. Descubrimiento ‚Üí B√∫squeda ‚Üí Comparaci√≥n ‚Üí Decisi√≥n ‚Üí Compra ‚Üí Post-compra ‚Üí Re-compra

### 3.2 Vendedor Sostenible (VENDOR)

**Demograf√≠a:**
- Tipo: PyMEs, emprendedores, marcas sostenibles
- Tama√±o: Chicas, medianas y grandes
- Categor√≠as: Se crea la categor√≠a de acuerdo al producto que se quiera vender

**Necesidades:**
- ‚úÖ Plataforma f√°cil de usar para publicar productos
- ‚úÖ Herramientas de gesti√≥n de inventario en tiempo real
- ‚úÖ Sistema de pagos confiable y r√°pido (Stripe)
- ‚úÖ Dashboard con analytics de ventas y performance
- ‚úÖ Visibilidad en un mercado objetivo
- ‚úÖ Gesti√≥n eficiente de √≥rdenes y env√≠os
- ‚úÖ Facilitarle al vendedor que pueda respaldar las buenas pr√°cticas que tiene en sus productos con nuestras certificaciones.


**Pain Points:**
- ‚ùå Altas comisiones en otras plataformas
- ‚ùå Dificultad para destacar entre competidores
- ‚ùå Procesos complejos de onboarding
- ‚ùå Falta de herramientas de marketing

**Herramientas Proporcionadas:**
- Dashboard de vendedor con m√©tricas en tiempo real
- Sistema de gesti√≥n de inventario
- Alertas de stock bajo, ventas y reembolsos
- Analytics de productos (vistas, conversi√≥n, ingresos, reviews)
- Sistema de Regen Score para mejorar posicionamiento y destacar en la comunidad 
- Gesti√≥n de √≥rdenes con estados (pending, processing, shipped, delivered)

### 3.3 Administrador de Plataforma (ADMIN)

**Responsabilidades:**
- Gesti√≥n de usuarios (aprobaci√≥n de vendedores, moderaci√≥n)
- Monitoreo de transacciones y resoluci√≥n de disputas
- An√°lisis de m√©tricas de plataforma (GMV, usuarios activos, etc)
- Verificaci√≥n de certificaciones de sostenibilidad
- Gesti√≥n de contenido y categor√≠as

**Herramientas:**
- Panel de administraci√≥n completo
- Sistema de moderaci√≥n de contenido
- Analytics de plataforma (GMV, usuarios activos, churn)
- Gesti√≥n de disputas y reembolsos
- Sistema de verificaci√≥n de vendedores

---

## 4. Requisitos Funcionales

### 4.1 Autenticaci√≥n y Gesti√≥n de Usuarios

#### RF-001: Registro de Usuario
- **Prioridad:** Alta
- **Descripci√≥n:** Los usuarios pueden registrarse con email/password o OAuth (Google)
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Validaci√≥n de email √∫nico
  - ‚úÖ Password con requisitos de seguridad (min 8 caracteres)
  - ‚úÖ Selecci√≥n de rol (Comprador/Vendedor) en onboarding
  - ‚úÖ Confirmaci√≥n de email obligatoria
  - ‚úÖ OAuth con Google implementado
- **Estado:** ‚úÖ Implementado (NextAuth.js)

#### RF-002: Inicio de Sesi√≥n
- **Prioridad:** Alta
- **Descripci√≥n:** Autenticaci√≥n segura multi-m√©todo
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Login con email/password
  - ‚úÖ Login con Google OAuth
  - ‚úÖ Sesiones persistentes con JWT
  - ‚úÖ Redirecci√≥n basada en rol
  - ‚úÖ Rate limiting para prevenir ataques
- **Estado:** ‚úÖ Implementado

#### RF-003: Onboarding Diferenciado
- **Prioridad:** Alta
- **Descripci√≥n:** Flujo de bienvenida personalizado por tipo de usuario
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Selecci√≥n de tipo de usuario (USER/VENDOR)
  - ‚úÖ Formulario de perfil de comprador (preferencias, intereses)
  - ‚úÖ Formulario extendido para vendedores (empresa, documentos)
  - ‚úÖ Educaci√≥n sobre NFTs y Regen Score
  - ‚úÖ Dashboard personalizado seg√∫n rol
- **Estado:** ‚úÖ Implementado

### 4.2 Gesti√≥n de Productos

#### RF-004: Publicaci√≥n de Productos (Vendedor)
- **Prioridad:** Alta
- **Descripci√≥n:** Vendedores pueden crear y gestionar productos
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Formulario de creaci√≥n con campos: nombre, descripci√≥n, precio, SKU, categor√≠a
  - ‚úÖ Upload de m√∫ltiples im√°genes (hasta 5)
  - ‚úÖ Gesti√≥n de inventario (stock, stock m√≠nimo)
  - ‚úÖ Configuraci√≥n de Regen Score del producto
  - ‚úÖ Tags de sostenibilidad (org√°nico, comercio justo, etc.)
  - ‚úÖ Previsualizaci√≥n antes de publicar
- **Estado:** ‚úÖ Implementado

#### RF-005: B√∫squeda y Filtrado de Productos
- **Prioridad:** Alta
- **Descripci√≥n:** Sistema de b√∫squeda avanzada con m√∫ltiples filtros
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ B√∫squeda por texto (nombre, descripci√≥n)
  - ‚úÖ Filtros por categor√≠a y subcategor√≠a
  - ‚úÖ Filtro por rango de precio
  - ‚úÖ Filtro por Regen Score (alto, medio, bajo)
  - ‚úÖ Ordenamiento (relevancia, precio, popularidad, nuevo)
  - ‚úÖ Integraci√≥n con Algolia para b√∫squeda r√°pida
- **Estado:** ‚úÖ Implementado (Algolia configurado)

#### RF-006: Carrito de Compras
- **Prioridad:** Alta
- **Descripci√≥n:** Sistema de carrito persistente multi-sesi√≥n
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Agregar/quitar productos del carrito
  - ‚úÖ Actualizar cantidad de productos
  - ‚úÖ Validaci√≥n de stock en tiempo real
  - ‚úÖ C√°lculo autom√°tico de subtotal y total
  - ‚úÖ Carrito persistente en base de datos
  - ‚úÖ Sidebar con vista r√°pida del carrito
  - ‚úÖ Sincronizaci√≥n entre dispositivos
- **Estado:** ‚úÖ Implementado

### 4.3 Proceso de Checkout y Pagos

#### RF-007: Flujo de Checkout
- **Prioridad:** Alta
- **Descripci√≥n:** Proceso de pago en 3 pasos (Carrito ‚Üí Env√≠o ‚Üí Pago)
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Paso 1: Revisi√≥n de productos en carrito
  - ‚úÖ Paso 2: Informaci√≥n de env√≠o (direcci√≥n, m√©todo)
  - ‚úÖ Paso 3: Informaci√≥n de pago
  - ‚úÖ Resumen de orden antes de confirmar
  - ‚úÖ Validaci√≥n de datos en cada paso
  - ‚úÖ Navegaci√≥n entre pasos (siguiente/anterior)
- **Estado:** ‚úÖ Implementado

#### RF-008: Procesamiento de Pagos (Stripe)
- **Prioridad:** Cr√≠tica
- **Descripci√≥n:** Integraci√≥n completa con Stripe para pagos seguros
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Stripe Elements para captura de tarjeta
  - ‚úÖ Creaci√≥n de Payment Intent
  - ‚úÖ Confirmaci√≥n de pago 3D Secure
  - ‚úÖ Manejo de errores de pago
  - ‚úÖ Webhooks para eventos de pago
  - ‚úÖ Moneda: MXN (Pesos Mexicanos)
  - ‚úÖ Estado de pago reflejado en orden
- **Estado:** ‚úÖ Implementado (Stripe Live Keys configuradas)

#### RF-009: Webhooks de Stripe
- **Prioridad:** Cr√≠tica
- **Descripci√≥n:** Automatizaci√≥n de procesos post-pago
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ `payment_intent.succeeded`: Actualizar orden a PROCESSING
  - ‚úÖ `payment_intent.failed`: Cancelar orden y restaurar stock
  - ‚úÖ `payment_intent.canceled`: Cancelar orden
  - ‚úÖ `charge.dispute.created`: Notificar a vendedor
  - ‚úÖ Creaci√≥n autom√°tica de notificaciones
  - ‚úÖ Actualizaci√≥n de estad√≠sticas de vendedor
  - ‚úÖ Limpieza autom√°tica del carrito
  - ‚úÖ Otorgamiento de puntos de lealtad
- **Estado:** ‚úÖ Implementado

### 4.4 Sistema de Notificaciones

#### RF-010: Notificaciones en Tiempo Real
- **Prioridad:** Media
- **Descripci√≥n:** Sistema de notificaciones multi-canal
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Notificaciones in-app con badge counter
  - ‚úÖ Tipos: pago exitoso, orden creada, env√≠o actualizado, disputa
  - ‚úÖ Marcado de le√≠do/no le√≠do
  - ‚úÖ Action URLs para navegaci√≥n directa
  - ‚úÖ Sistema de preferencias de notificaciones
  - ‚úÖ Hist√≥rico de notificaciones
- **Estado:** ‚úÖ Implementado

### 4.5 Sistema de Reviews y Ratings

#### RF-011: Valoraciones de Productos
- **Prioridad:** Media
- **Descripci√≥n:** Sistema de reviews verificadas
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Solo compradores verificados pueden dejar reviews
  - ‚úÖ Rating de 1-5 estrellas
  - ‚úÖ Comentario de texto opcional
  - ‚úÖ Display de rating promedio en producto
  - ‚úÖ Moderaci√≥n de reviews por admin
  - ‚úÖ Reviews ordenadas por utilidad/fecha
- **Estado:** ‚úÖ Implementado

### 4.6 Gesti√≥n de √ìrdenes

#### RF-012: Tracking de √ìrdenes
- **Prioridad:** Alta
- **Descripci√≥n:** Sistema completo de seguimiento de √≥rdenes
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Estados: PENDING ‚Üí PROCESSING ‚Üí SHIPPED ‚Üí DELIVERED ‚Üí COMPLETED
  - ‚úÖ Vista de √≥rdenes para comprador
  - ‚úÖ Vista de √≥rdenes para vendedor
  - ‚úÖ Actualizaci√≥n manual de estado por vendedor
  - ‚úÖ Historial de cambios de estado
  - ‚úÖ Detalles completos de orden (productos, precio, env√≠o)
  - ‚úÖ Opci√≥n de cancelaci√≥n (condiciones aplicables)
- **Estado:** ‚úÖ Implementado

### 4.7 Dashboard y Analytics

#### RF-013: Dashboard de Vendedor
- **Prioridad:** Alta
- **Descripci√≥n:** Panel de control con m√©tricas clave
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ M√©tricas: ventas totales, ingresos, productos, √≥rdenes
  - ‚úÖ Gr√°fica de ventas (√∫ltimos 7/30 d√≠as)
  - ‚úÖ Top productos vendidos
  - ‚úÖ Regen Score con progreso
  - ‚úÖ NFT evolutivo y nivel actual
  - ‚úÖ Alertas de stock bajo
  - ‚úÖ Panel de certificaciones
- **Estado:** ‚úÖ Implementado

#### RF-014: Dashboard de Comprador
- **Prioridad:** Media
- **Descripci√≥n:** Vista personalizada para compradores
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ √ìrdenes recientes
  - ‚úÖ Wishlist
  - ‚úÖ Regen Score acumulado
  - ‚úÖ Puntos de lealtad
  - ‚úÖ NFTs coleccionados
  - ‚úÖ Impacto ambiental (CO2 evitado)
  - ‚úÖ Recomendaciones personalizadas
- **Estado:** ‚úÖ Implementado

### 4.8 Sistema de Regen Score y Gamificaci√≥n

#### RF-015: Regen Score
- **Prioridad:** Alta
- **Descripci√≥n:** Sistema de puntuaci√≥n de sostenibilidad
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ C√°lculo de score basado en atributos del producto
  - ‚úÖ Score para vendedores (promedio de productos)
  - ‚úÖ Score para compradores (suma de compras)
  - ‚úÖ Display visual en cards y detalles
  - ‚úÖ Filtrado por nivel de score
- **Estado:** ‚úÖ Implementado

#### RF-016: NFTs Evolutivos
- **Prioridad:** Media
- **Descripci√≥n:** Sistema de coleccionables digitales
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Niveles: Semilla Verde ‚Üí Brote Floreciente ‚Üí √Årbol Firme ‚Üí Bosque Completo
  - ‚úÖ Evoluci√≥n basada en Regen Score
  - ‚úÖ Metadata almacenado en JSON
  - ‚úÖ Display en dashboard
  - ‚úÖ Galer√≠a de NFTs para comprador
- **Estado:** ‚úÖ Implementado (metadata en DB)

#### RF-017: Loyalty Points
- **Prioridad:** Media
- **Descripci√≥n:** Sistema de puntos de lealtad
- **Criterios de Aceptaci√≥n:**
  - ‚úÖ Otorgamiento autom√°tico post-compra
  - ‚úÖ C√°lculo: 1 punto por cada 10 puntos de Regen Score
  - ‚úÖ Display de balance de puntos
  - ‚úÖ Historial de puntos ganados
- **Estado:** ‚úÖ Implementado (redenci√≥n pendiente)

### 4.9 Mensajer√≠a (Futuro)
- **Prioridad:** Baja (Fase 2)
- **Estado:** üîÑ Planeado para v2.0

---

## 5. Requisitos No Funcionales

### 5.1 Disponibilidad y Confiabilidad

**NFR-001: Tiempo de Actividad**
- **Objetivo:** 99.9% uptime (8.76 horas de downtime/a√±o permitido)
- **Estrategia:**
  - Hosting en Vercel con edge network
  - Database en servicio managed (Railway/Supabase)
  - Health checks autom√°ticos
  - Monitoreo 24/7 con alertas
- **Estado:** ‚úÖ Implementado (Vercel + PostgreSQL managed)

**NFR-002: Disaster Recovery**
- **Objetivo:** RPO (Recovery Point Objective) < 1 hora
- **Objetivo:** RTO (Recovery Time Objective) < 4 horas
- **Estrategia:**
  - Backups autom√°ticos diarios de BD
  - Snapshots de BD cada 6 horas
  - Restore testing mensual
- **Estado:** ‚è≥ Pendiente configuraci√≥n

### 5.2 Seguridad

**NFR-003: Procesamiento Seguro de Pagos**
- **Est√°ndar:** PCI DSS Level 1 Compliance (delegado a Stripe)
- **Implementaci√≥n:**
  - ‚úÖ Stripe Elements (datos de tarjeta nunca tocan servidor)
  - ‚úÖ HTTPS obligatorio en todos los endpoints
  - ‚úÖ Webhook signature verification
  - ‚úÖ Environment variables para keys sensibles
- **Estado:** ‚úÖ Implementado

**NFR-004: Autenticaci√≥n y Autorizaci√≥n**
- **Implementaci√≥n:**
  - ‚úÖ NextAuth.js con JWT
  - ‚úÖ Hashing de passwords con bcrypt (10 rounds)
  - ‚úÖ Role-based access control (RBAC)
  - ‚úÖ Session expiration (30 d√≠as)
  - ‚úÖ CSRF protection
- **Estado:** ‚úÖ Implementado

**NFR-005: Protecci√≥n de Datos (GDPR/LFPDPPP)**
- **Cumplimiento:** RGPD (Europa) y Ley Federal de Protecci√≥n de Datos (M√©xico)
- **Implementaci√≥n:**
  - ‚úÖ Consentimiento expl√≠cito en registro
  - ‚úÖ Pol√≠ticas de privacidad y t√©rminos
  - ‚úÖ Derecho al olvido (eliminaci√≥n de cuenta)
  - ‚úÖ Encriptaci√≥n de datos sensibles en reposo
  - ‚úÖ Logs de acceso a datos personales
  - ‚è≥ Portal de preferencias de privacidad (pendiente)
- **Estado:** üü° Parcialmente implementado

### 5.3 Performance

**NFR-006: Tiempos de Respuesta**
- **Objetivo:**
  - P√°ginas est√°ticas: < 1 segundo (LCP)
  - P√°ginas din√°micas: < 2 segundos (LCP)
  - API endpoints: < 500ms (p95)
  - B√∫squeda: < 300ms (Algolia)
- **Optimizaciones:**
  - ‚úÖ Next.js SSG/ISR donde sea posible
  - ‚úÖ Next.js Image optimization
  - ‚úÖ Code splitting autom√°tico
  - ‚úÖ React Server Components
  - ‚úÖ Database query optimization (Prisma)
- **Estado:** ‚úÖ Implementado

**NFR-007: Escalabilidad**
- **Objetivo:** Soportar 10,000 usuarios concurrentes
- **Arquitectura:**
  - ‚úÖ Serverless functions (Vercel Edge)
  - ‚úÖ CDN global para assets est√°ticos
  - ‚úÖ Connection pooling en BD (Prisma)
  - ‚úÖ Caching con TanStack Query
  - ‚è≥ Redis para sesiones y cache (futuro)
- **Estado:** üü° Base implementada

### 5.4 Usabilidad

**NFR-008: Accesibilidad (WCAG 2.1 AA)**
- **Implementaci√≥n:**
  - ‚úÖ Contraste de colores adecuado
  - ‚úÖ Navegaci√≥n por teclado
  - ‚úÖ ARIA labels en componentes
  - ‚úÖ Formularios con labels asociados
  - ‚è≥ Screen reader testing
- **Estado:** üü° Parcialmente implementado

**NFR-009: Responsive Design**
- **Breakpoints:** 320px, 640px, 768px, 1024px, 1280px, 1536px
- **Implementaci√≥n:**
  - ‚úÖ Mobile-first approach
  - ‚úÖ Tailwind responsive utilities
  - ‚úÖ Touch-friendly UI (min 44px tap targets)
  - ‚úÖ Testing en Chrome, Safari, Firefox
- **Estado:** ‚úÖ Implementado

**NFR-010: Internacionalizaci√≥n (i18n)**
- **Idiomas:** Espa√±ol (primary), Ingl√©s (futuro)
- **Estado:** ‚è≥ Planeado para v2.0

### 5.5 Mantenibilidad

**NFR-011: Testing**
- **Cobertura:** M√≠nimo 70% en funciones cr√≠ticas
- **Implementaci√≥n:**
  - ‚úÖ Jest + React Testing Library (Unit tests)
  - ‚úÖ Playwright (E2E tests)
  - ‚úÖ 13 unit tests passing
  - ‚úÖ 7 E2E tests passing
  - ‚è≥ Integration tests (API)
- **Estado:** ‚úÖ Configurado y funcionando

**NFR-012: Documentaci√≥n**
- **Implementaci√≥n:**
  - ‚úÖ README.md con setup
  - ‚úÖ ARCHITECTURE.md (arquitectura t√©cnica)
  - ‚úÖ STRIPE_SETUP.md (configuraci√≥n pagos)
  - ‚úÖ README.testing.md (gu√≠a de testing)
  - ‚úÖ PRD.md (este documento)
  - ‚è≥ API documentation (Swagger/OpenAPI)
  - ‚è≥ Component Storybook
- **Estado:** üü° Documentaci√≥n base completa

**NFR-013: Code Quality**
- **Herramientas:**
  - ‚úÖ TypeScript strict mode
  - ‚úÖ ESLint con reglas Next.js
  - ‚úÖ Prettier para formatting
  - ‚è≥ Husky para git hooks
  - ‚è≥ SonarQube para an√°lisis de c√≥digo
- **Estado:** üü° Base implementada

---

## 6. Supuestos y Dependencias

### 6.1 Supuestos T√©cnicos

**Infraestructura:**
- ‚úÖ Los usuarios tienen acceso estable a Internet (min 3G)
- ‚úÖ Los navegadores soportan JavaScript moderno (ES2020+)
- ‚úÖ Stripe soporta MXN y procesamiento en M√©xico
- ‚úÖ Database PostgreSQL puede escalar seg√∫n demanda

**Usuarios:**
- Los compradores tienen m√©todos de pago v√°lidos (tarjeta d√©bito/cr√©dito)
- Los vendedores pueden proporcionar documentaci√≥n legal (RFC, comprobante domicilio)
- Los usuarios aceptan pol√≠ticas de privacidad y t√©rminos de servicio

### 6.2 Dependencias Externas

**Servicios de Terceros:**
| Servicio | Prop√≥sito | SLA | Contingencia |
|----------|-----------|-----|--------------|
| **Stripe** | Procesamiento de pagos | 99.99% | Fallback a transferencia bancaria |
| **Vercel** | Hosting y deployment | 99.99% | Migration plan a Railway/Render |
| **PostgreSQL** | Base de datos | 99.95% | Backups diarios autom√°ticos |
| **Algolia** | B√∫squeda | 99.99% | Fallback a b√∫squeda b√°sica (Prisma) |
| **Google OAuth** | Autenticaci√≥n | 99.9% | Fallback a email/password |

**APIs y SDKs:**
- Next.js 14 (estable)
- Prisma 6.16 (estable)
- Stripe API v2025-08-27
- NextAuth.js v4.24

### 6.3 Restricciones

**T√©cnicas:**
- L√≠mite de upload de im√°genes: 5MB por imagen, 5 im√°genes por producto
- L√≠mite de productos por vendedor en MVP: Sin l√≠mite
- L√≠mite de items en carrito: 50 productos
- Session timeout: 30 d√≠as de inactividad

**Regulatorias:**
- Cumplimiento con Ley Federal de Protecci√≥n de Datos (M√©xico)
- Cumplimiento con GDPR (si hay usuarios EU)
- Cumplimiento PCI DSS (delegado a Stripe)
- SAT: Facturaci√≥n electr√≥nica (Fase 2)

**Presupuesto:**
- Budget mensual servicios cloud: $500 USD
- Comisi√≥n Stripe: 3.6% + $3 MXN por transacci√≥n
- Costos de hosting escalables seg√∫n tr√°fico

---

## 7. Interacci√≥n del Usuario / Dise√±o

### 7.1 Flujos de Usuario Principales

#### Flujo 1: Registro y Onboarding de Comprador
```
1. Landing Page ‚Üí [Registrarse]
2. Formulario de Registro (email, password, nombre)
3. Verificaci√≥n de Email
4. Selecci√≥n de Rol ‚Üí "Soy Comprador"
5. Onboarding: Preferencias (categor√≠as, rango precio)
6. Educaci√≥n: "¬øQu√© es el Regen Score?"
7. Dashboard de Comprador (personalizado)
```

#### Flujo 2: Registro y Onboarding de Vendedor
```
1. Landing Page ‚Üí [Vender en Regen]
2. Formulario de Registro
3. Verificaci√≥n de Email
4. Selecci√≥n de Rol ‚Üí "Soy Vendedor"
5. Formulario de Empresa (RFC, raz√≥n social, categor√≠a)
6. Verificaci√≥n de Documentos (manual por admin)
7. Aprobaci√≥n ‚Üí Dashboard de Vendedor
```

#### Flujo 3: Publicaci√≥n de Producto (Vendedor)
```
1. Dashboard Vendedor ‚Üí [Agregar Producto]
2. Formulario: Informaci√≥n B√°sica (nombre, descripci√≥n, categor√≠a)
3. Formulario: Precios e Inventario (precio, stock, SKU)
4. Upload de Im√°genes (drag & drop, hasta 5)
5. Configuraci√≥n de Sostenibilidad (Regen Score, tags)
6. Preview del Producto
7. [Publicar] ‚Üí Producto visible en marketplace
```

#### Flujo 4: Compra de Producto (Comprador)
```
1. Marketplace/B√∫squeda ‚Üí Explorar productos
2. Filtrar por categor√≠a, precio, Regen Score
3. Clic en Producto ‚Üí Vista de Detalle
4. [Agregar al Carrito] ‚Üí Sidebar de carrito se abre
5. [Ir al Checkout]
6. PASO 1: Revisar Carrito (editar cantidades)
7. PASO 2: Informaci√≥n de Env√≠o (direcci√≥n, m√©todo)
8. PASO 3: Informaci√≥n de Pago (Stripe Elements)
9. [Confirmar Pago]
10. Procesamiento ‚Üí Stripe Payment Intent
11. Confirmaci√≥n de Orden ‚Üí Email + Notificaci√≥n
12. Dashboard ‚Üí Ver orden en "Mis Compras"
```

#### Flujo 5: Gesti√≥n de Orden (Vendedor)
```
1. Dashboard Vendedor ‚Üí Notificaci√≥n "Nueva Orden"
2. [Ver Orden] ‚Üí Detalles completos
3. Verificar productos y preparar env√≠o
4. Actualizar estado: PENDING ‚Üí PROCESSING
5. Embalar y enviar productos
6. Actualizar estado: PROCESSING ‚Üí SHIPPED (agregar tracking)
7. Comprador recibe ‚Üí Marcar DELIVERED
8. Sistema autom√°tico ‚Üí COMPLETED despu√©s de 7 d√≠as
9. Comprador puede dejar review
```

#### Flujo 6: Sistema de Webhooks Post-Pago
```
[Evento Stripe: payment_intent.succeeded]
  ‚Üì
1. Webhook recibido en /api/webhooks/stripe
2. Verificar signature de Stripe
3. Actualizar orden: status ‚Üí PROCESSING, paymentStatus ‚Üí PAID
4. Crear notificaci√≥n para COMPRADOR: "Pago Confirmado"
5. Crear notificaci√≥n para VENDEDOR: "Nuevo Pedido"
6. Incrementar sales count del producto
7. Limpiar items del carrito del comprador
8. Calcular y otorgar Loyalty Points (Regen Score / 10)
9. Actualizar Regen Score del comprador
10. Verificar evoluci√≥n de NFT
11. Email de confirmaci√≥n (futuro)
```

### 7.2 Wireframes y Mockups

#### P√°gina de Marketplace
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Header: Logo | B√∫squeda | Carrito(3) | Avatar  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [Filtros Sidebar]     ‚îÇ  [Grid de Productos]   ‚îÇ
‚îÇ                        ‚îÇ                        ‚îÇ
‚îÇ  ‚òëÔ∏è Categor√≠as          ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚òê Alimentos           ‚îÇ  ‚îÇImg  ‚îÇ ‚îÇImg  ‚îÇ      ‚îÇ
‚îÇ  ‚òê Moda                ‚îÇ  ‚îÇ $500‚îÇ ‚îÇ $300‚îÇ      ‚îÇ
‚îÇ  ‚òê Hogar               ‚îÇ  ‚îÇ‚≠ê‚≠ê‚≠ê‚≠ê‚îÇ ‚îÇ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚îÇ      ‚îÇ
‚îÇ                        ‚îÇ  ‚îÇüå± 85 ‚îÇ ‚îÇüå± 92 ‚îÇ      ‚îÇ
‚îÇ  Rango de Precio       ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ  [_____|_____]         ‚îÇ                        ‚îÇ
‚îÇ  $0        $1000       ‚îÇ  [Cargar m√°s]          ‚îÇ
‚îÇ                        ‚îÇ                        ‚îÇ
‚îÇ  Regen Score           ‚îÇ                        ‚îÇ
‚îÇ  ‚óã Todos               ‚îÇ                        ‚îÇ
‚îÇ  ‚óã Alto (80+)          ‚îÇ                        ‚îÇ
‚îÇ  ‚óã Medio (50-79)       ‚îÇ                        ‚îÇ
‚îÇ  ‚óã Bajo (<50)          ‚îÇ                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Dashboard de Vendedor
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üè™ Mi Tienda: EcoVendor                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üì¶ 45    ‚îÇ üí∞ $45K  ‚îÇ üìä 125   ‚îÇ üå± Score: 78  ‚îÇ
‚îÇ √ìrdenes  ‚îÇ Ingresos ‚îÇ Productos‚îÇ ‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñë    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  [Gr√°fica de Ventas - √öltimos 30 d√≠as]         ‚îÇ
‚îÇ     ^                                           ‚îÇ
‚îÇ  $  ‚îÇ     ‚ï±‚ï≤    ‚ï±‚ï≤                              ‚îÇ
‚îÇ     ‚îÇ  ‚ï±‚ï≤‚ï±  ‚ï≤‚ï±‚ï≤‚ï±  ‚ï≤‚ï±‚ï≤                           ‚îÇ
‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí d√≠as                   ‚îÇ
‚îÇ                                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  √ìrdenes Recientes           | NFT & Score     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ #1234 - $500           ‚îÇ  ‚îÇ ‚îÇ   üå≥       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ Juan P. | PROCESSING   ‚îÇ  ‚îÇ ‚îÇ √Årbol Firme‚îÇ  ‚îÇ
‚îÇ  ‚îÇ [Ver detalles]         ‚îÇ  ‚îÇ ‚îÇ Nivel 3/4  ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                              ‚îÇ                  ‚îÇ
‚îÇ  [+ Agregar Producto]        ‚îÇ Pr√≥ximo: +15pts ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Checkout - Paso 3: Pago
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Checkout - Paso 3 de 3: Pago                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  [1 ‚úì]  [2 ‚úì]  [3 ‚óè]                           ‚îÇ
‚îÇ  Carrito  Env√≠o  Pago                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                 ‚îÇ
‚îÇ  üí≥ Informaci√≥n de Pago                         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ [Stripe Elements - Card Input]            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ **** **** **** 1234                       ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ MM/YY   CVC                               ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  üîí Pago seguro con Stripe                      ‚îÇ
‚îÇ                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ Resumen de Orden                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ Subtotal:           $1,200.00 MXN       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ Env√≠o:                $150.00 MXN       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ Total:             $1,350.00 MXN       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ [Pagar $1,350.00]                       ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 7.3 Sistema de Dise√±o

**Paleta de Colores:**
- **Primary:** Verde Sostenible (#10B981 - Tailwind green-500)
- **Secondary:** Tierra (#92400E - Tailwind amber-800)
- **Accent:** Cielo (#3B82F6 - Tailwind blue-500)
- **Neutral:** Grises (#6B7280, #9CA3AF, #D1D5DB)
- **Success:** #22C55E
- **Warning:** #F59E0B
- **Error:** #EF4444

**Tipograf√≠a:**
- **Heading:** Geist Sans (Variable font)
- **Body:** Geist Sans
- **Monospace:** Geist Mono

**Componentes Base (shadcn/ui):**
- ‚úÖ Button (6 variants, 4 sizes)
- ‚úÖ Card, Badge, Avatar
- ‚úÖ Input, Select, Checkbox, Switch
- ‚úÖ Dialog, Alert, Toast
- ‚úÖ Carousel, Tabs, Accordion
- ‚úÖ Progress, Slider
- ‚úÖ Chart (Recharts)

---

## 8. Fuera del Alcance (Out of Scope)

### Fase 1 - MVP (No Incluido)

‚ùå **Pagos Offline**
- Transferencias bancarias directas
- Pago contra entrega (COD)
- Raz√≥n: Complejidad de reconciliaci√≥n y riesgo de fraude

‚ùå **Dep√≥sito en Garant√≠a (Escrow) basado en Blockchain**
- Smart contracts para pagos
- Integraci√≥n con wallets crypto
- Raz√≥n: Complejidad t√©cnica, regulaci√≥n incierta, audiencia limitada

‚ùå **Mensajer√≠a en Tiempo Real**
- Chat en vivo comprador-vendedor
- Video llamadas
- Raz√≥n: Requiere infraestructura WebSocket/WebRTC

‚ùå **App M√≥vil Nativa**
- iOS/Android apps
- Raz√≥n: PWA suficiente para MVP, recursos limitados

‚ùå **Marketplace Multi-vendor en Una Orden**
- Comprar de m√∫ltiples vendedores en un checkout
- Raz√≥n: Complejidad de splitting de pagos

‚ùå **Sistema de Subastas**
- Productos en subasta con pujas
- Raz√≥n: Modelo de negocio diferente

‚ùå **Programa de Afiliados**
- Referral system con comisiones
- Raz√≥n: No es prioridad para MVP

‚ùå **Facturaci√≥n Electr√≥nica (CFDI)**
- Generaci√≥n autom√°tica de facturas SAT
- Raz√≥n: Complejidad regulatoria, se priorizar√° en Fase 2

‚ùå **Log√≠stica Integrada**
- Integraci√≥n con paqueter√≠as (DHL, FedEx)
- Generaci√≥n de gu√≠as autom√°ticas
- Raz√≥n: Vendedores gestionan env√≠o manualmente en MVP

‚ùå **An√°lisis de Impacto Ambiental Detallado**
- C√°lculo real de huella de carbono
- Certificaciones oficiales (Carbon Trust)
- Raz√≥n: Requiere partnerships y datos complejos

‚ùå **Soporte Multimoneda**
- Precios en USD, EUR, etc.
- Raz√≥n: Solo MXN en MVP (M√©xico)

### Consideraciones Futuras (Roadmap)

**Fase 2 (6-12 meses):**
- üì± PWA avanzada con offline mode
- üí¨ Mensajer√≠a b√°sica (as√≠ncrona)
- üìÑ Facturaci√≥n electr√≥nica (SAT)
- üöö Integraci√≥n con paqueter√≠as
- üåé Expansi√≥n a 3 pa√≠ses LATAM
- üîó Sistema de afiliados

**Fase 3 (12-18 meses):**
- üì≤ App nativa iOS/Android
- ‚õìÔ∏è Blockchain/NFTs reales (en wallet externo)
- ü§ñ Recomendaciones con IA
- üåç An√°lisis de impacto ambiental verificado
- üí± Soporte multimoneda
- üîÑ Marketplace multi-vendor en una orden

---

## 9. M√©tricas de √âxito y KPIs

### 9.1 M√©tricas de Producto

**Adopci√≥n:**
- Nuevos registros: 500/semana
- Tasa de conversi√≥n registro‚Üícompra: 25%
- Vendedores activos: 500 en 6 meses

**Engagement:**
- DAU (Daily Active Users): 2,000
- MAU (Monthly Active Users): 10,000
- Sesiones por usuario: 3/semana
- Tiempo promedio en sitio: 8 minutos

**Retenci√≥n:**
- Retenci√≥n D1: 40%
- Retenci√≥n D7: 25%
- Retenci√≥n D30: 60%
- Churn rate: <15%/mes

### 9.2 M√©tricas de Negocio

**Revenue:**
- GMV (Gross Merchandise Value): $5M MXN/mes
- Comisi√≥n promedio: 8% GMV
- Revenue mensual: $400K MXN
- AOV (Average Order Value): $500 MXN

**Eficiencia:**
- CAC (Customer Acquisition Cost): <$50 MXN
- LTV (Lifetime Value): >$2,000 MXN
- LTV/CAC ratio: >40:1
- Payback period: <2 meses

**Marketplace Health:**
- Take rate: 8%
- Tiempo promedio de fulfillment: <3 d√≠as
- Tasa de disputas: <1%
- Net Promoter Score (NPS): >50

### 9.3 M√©tricas T√©cnicas

**Performance:**
- Largest Contentful Paint (LCP): <2.5s
- First Input Delay (FID): <100ms
- Cumulative Layout Shift (CLS): <0.1
- Uptime: >99.9%

**Calidad:**
- Code coverage: >70%
- Bug rate: <5 bugs cr√≠ticos/mes
- Time to resolve (P0): <4 horas
- Time to resolve (P1): <24 horas

**Seguridad:**
- Incidents de seguridad: 0 en 6 meses
- Vulnerabilidades cr√≠ticas: 0
- Time to patch: <48 horas
- Compliance audits: Pass 100%

### 9.4 M√©tricas de Sostenibilidad (√önica)

**Impacto Ambiental:**
- CO2 evitado total: 50 toneladas (estimado)
- Productos con Regen Score >80: 60% del cat√°logo
- Vendedores con certificaci√≥n sostenible: 70%

**Engagement Sostenible:**
- % usuarios con Regen Score >500: 40%
- NFTs evolutivos: 30% de usuarios en nivel 3+
- Loyalty points redimidos: 20% del total otorgado

---

## 10. Cronograma y Fases

### Fase 0: Setup y Fundamentos ‚úÖ COMPLETADO
**Duraci√≥n:** 2 semanas
**Estado:** ‚úÖ Completado

- [x] Setup de proyecto Next.js + TypeScript
- [x] Configuraci√≥n de Prisma + PostgreSQL
- [x] Integraci√≥n de NextAuth.js
- [x] Setup de Stripe (Live Keys)
- [x] Dise√±o de base de datos (15 modelos)
- [x] Arquitectura de carpetas
- [x] Sistema de componentes UI (shadcn/ui)

### Fase 1: MVP Core Features ‚úÖ COMPLETADO
**Duraci√≥n:** 6 semanas
**Estado:** ‚úÖ ~90% Completado

**Sprint 1-2: Autenticaci√≥n y Usuarios**
- [x] Sistema de registro/login
- [x] Onboarding diferenciado por rol
- [x] Perfiles de usuario y vendedor
- [x] OAuth con Google

**Sprint 3-4: Marketplace y Productos**
- [x] Cat√°logo de productos
- [x] B√∫squeda y filtros (Algolia)
- [x] Carrito de compras
- [x] Sistema de Regen Score
- [x] Gesti√≥n de inventario

**Sprint 5-6: Checkout y Pagos**
- [x] Flujo de checkout (3 pasos)
- [x] Integraci√≥n Stripe (Payment Intents)
- [x] Webhooks de Stripe
- [x] Gesti√≥n de √≥rdenes
- [x] Sistema de notificaciones

### Fase 2: Features Avanzados ‚è≥ EN PROGRESO
**Duraci√≥n:** 4 semanas
**Estado:** üü° 40% Completado

**Sprint 7-8: Gamificaci√≥n y Analytics**
- [x] Dashboard de vendedor con m√©tricas
- [x] Dashboard de comprador
- [x] Sistema de NFTs evolutivos
- [x] Loyalty points
- [ ] Gr√°ficas de impacto ambiental
- [ ] Recomendaciones personalizadas

**Sprint 9-10: Testing y QA**
- [x] Setup de Jest + React Testing Library
- [x] Setup de Playwright
- [x] 13 unit tests implementados
- [x] 7 E2E tests implementados
- [ ] Integration tests (API)
- [ ] Load testing
- [ ] Security audit

### Fase 3: Pre-Launch üîÑ PLANEADO
**Duraci√≥n:** 2 semanas
**Estado:** ‚è≥ Pendiente

**Sprint 11: Optimizaci√≥n y Bug Fixes**
- [ ] Performance optimization
- [ ] SEO optimization
- [ ] Bug fixing basado en QA
- [ ] Cross-browser testing
- [ ] Accessibility audit (WCAG AA)

**Sprint 12: Launch Preparation**
- [ ] Documentaci√≥n completa
- [ ] Onboarding de primeros vendedores (beta)
- [ ] Marketing materials
- [ ] Analytics setup (Google Analytics, Mixpanel)
- [ ] Monitoring y alerting (Sentry, Datadog)

### Fase 4: Launch y Post-Launch üöÄ FUTURO
**Mes 1 Post-Launch:**
- [ ] Soft launch (100 usuarios beta)
- [ ] Recolecci√≥n de feedback
- [ ] Iteraci√≥n r√°pida en features cr√≠ticos
- [ ] Monitoreo de m√©tricas en tiempo real

**Mes 2-3 Post-Launch:**
- [ ] Public launch
- [ ] Marketing campaigns
- [ ] Onboarding masivo de vendedores
- [ ] A/B testing en conversi√≥n
- [ ] Expansi√≥n de cat√°logo

**Mes 4-6 Post-Launch:**
- [ ] Alcanzar 10,000 usuarios activos
- [ ] 10,000 transacciones/mes
- [ ] Features de Fase 2 (mensajer√≠a, facturaci√≥n)
- [ ] Evaluaci√≥n de expansi√≥n geogr√°fica

---

## 11. Riesgos y Mitigaciones

### Riesgos T√©cnicos

| Riesgo | Probabilidad | Impacto | Mitigaci√≥n |
|--------|--------------|---------|------------|
| **Downtime de Stripe** | Baja | Alto | - Monitoring 24/7<br>- Fallback a transferencia<br>- Comunicaci√≥n proactiva |
| **Escalabilidad de BD** | Media | Alto | - Connection pooling<br>- Query optimization<br>- Read replicas (futuro) |
| **Ataques DDoS** | Media | Medio | - Cloudflare protection<br>- Rate limiting<br>- WAF rules |
| **Breach de seguridad** | Baja | Cr√≠tico | - Security audits peri√≥dicos<br>- Penetration testing<br>- Bug bounty program |
| **P√©rdida de datos** | Baja | Cr√≠tico | - Backups autom√°ticos diarios<br>- Point-in-time recovery<br>- Disaster recovery plan |

### Riesgos de Negocio

| Riesgo | Probabilidad | Impacto | Mitigaci√≥n |
|--------|--------------|---------|------------|
| **Baja adopci√≥n de vendedores** | Media | Alto | - Incentivos de onboarding<br>- Comisi√≥n 0% primer mes<br>- Training y soporte |
| **Baja conversi√≥n compradores** | Media | Alto | - A/B testing continuo<br>- Mejora UX basada en analytics<br>- Promociones de lanzamiento |
| **Fraude en pagos** | Media | Medio | - Stripe Radar (anti-fraud)<br>- Verificaci√≥n manual de √≥rdenes grandes<br>- L√≠mites por usuario nuevo |
| **Competencia de gigantes** | Alta | Medio | - Diferenciaci√≥n en sostenibilidad<br>- Nicho de mercado claro<br>- Community building |
| **Cambios regulatorios** | Baja | Medio | - Legal counsel<br>- Compliance monitoring<br>- Flexibilidad arquitect√≥nica |

### Riesgos de Producto

| Riesgo | Probabilidad | Impacto | Mitigaci√≥n |
|--------|--------------|---------|------------|
| **Feature creep** | Alta | Medio | - PRD estricto<br>- Priorizaci√≥n clara<br>- Out of scope bien definido |
| **Mala UX en onboarding** | Media | Alto | - User testing temprano<br>- Iteraci√≥n r√°pida<br>- Analytics de funnel |
| **Regen Score no valorado** | Media | Alto | - Educaci√≥n en onboarding<br>- Gamificaci√≥n atractiva<br>- Marketing de impacto |
| **Complejidad para vendedores** | Media | Medio | - Simplificaci√≥n de flujos<br>- Wizards paso a paso<br>- Video tutoriales |

---

## 12. Stakeholders y Responsabilidades

### Equipo Actual

| Rol | Responsabilidades | Persona |
|-----|-------------------|---------|
| **Product Owner** | Visi√≥n de producto, priorizaci√≥n, PRD | [Tu nombre] |
| **Tech Lead / Desarrollador** | Arquitectura, desarrollo, c√≥digo | [Tu nombre] |
| **QA Engineer** | Testing, calidad, bug tracking | [Pendiente contratar] |
| **UI/UX Designer** | Dise√±o de interfaces, research | [Freelance/Pendiente] |

### Equipo Futuro (Post-Launch)

| Rol | Responsabilidades | Contrataci√≥n |
|-----|-------------------|--------------|
| **Backend Developer** | APIs, integraciones, performance | Mes 2 |
| **Frontend Developer** | UI implementation, optimizaci√≥n | Mes 2 |
| **DevOps Engineer** | Infraestructura, CI/CD, monitoring | Mes 3 |
| **Customer Support** | Soporte usuarios, vendedores | Mes 1 |
| **Marketing Manager** | Growth, adquisici√≥n, branding | Pre-launch |
| **Community Manager** | Redes sociales, engagement | Mes 1 |

### Stakeholders Externos

- **Usuarios Beta:** Feedback temprano y validaci√≥n
- **Vendedores Piloto:** Co-creaci√≥n de features para vendedores
- **Inversionistas:** Reportes de progreso y m√©tricas
- **Partners Sostenibilidad:** Certificaciones y credibilidad

---

## 13. Ap√©ndices

### A. Stack Tecnol√≥gico Detallado

**Frontend:**
```json
{
  "framework": "Next.js 14.2.25",
  "language": "TypeScript 5.7.3",
  "styling": "TailwindCSS 3.4.17",
  "components": "shadcn/ui (Radix UI)",
  "state": "Redux Toolkit 2.2.7 + TanStack Query 5.51",
  "forms": "react-hook-form 7.54 + Zod 3.24",
  "charts": "Recharts 2.15"
}
```

**Backend:**
```json
{
  "runtime": "Node.js (Vercel Serverless)",
  "database": "PostgreSQL 16",
  "orm": "Prisma 6.16.2",
  "auth": "NextAuth.js 4.24.11",
  "payments": "Stripe 18.5.0",
  "search": "Algolia 4.24"
}
```

**DevOps:**
```json
{
  "hosting": "Vercel",
  "database_host": "Railway/Supabase",
  "monitoring": "Vercel Analytics",
  "testing": "Jest 30.2 + Playwright 1.55"
}
```

### B. Modelo de Base de Datos

**Modelos Principales:**
1. User (usuarios del sistema)
2. UserProfile (perfiles de compradores)
3. Vendor (perfiles de vendedores)
4. Product (productos del marketplace)
5. Order (√≥rdenes de compra)
6. OrderItem (items de √≥rdenes)
7. CartItem (items en carrito)
8. Review (rese√±as de productos)
9. Notification (notificaciones)
10. Address (direcciones de env√≠o)
11. PaymentMethod (m√©todos de pago guardados)
12. WishlistItem (lista de deseos)
13. Account (cuentas OAuth)
14. Session (sesiones de usuario)
15. VerificationToken (tokens de verificaci√≥n)

**Relaciones Clave:**
- User ‚Üí UserProfile (1:1)
- User ‚Üí Vendor (1:1)
- Vendor ‚Üí Product (1:N)
- User ‚Üí Order (1:N)
- Vendor ‚Üí Order (1:N)
- Order ‚Üí OrderItem (1:N)
- Product ‚Üí OrderItem (1:N)
- User ‚Üí CartItem (1:N)
- Product ‚Üí Review (1:N)

### C. Endpoints de API Principales

**Autenticaci√≥n:**
- `POST /api/auth/signup` - Registro
- `POST /api/auth/login` - Login
- `POST /api/auth/logout` - Logout
- `GET /api/auth/session` - Obtener sesi√≥n

**Productos:**
- `GET /api/products` - Listar productos (con filtros)
- `GET /api/products/:id` - Detalle de producto
- `POST /api/products` - Crear producto (vendor)
- `PUT /api/products/:id` - Actualizar producto (vendor)
- `DELETE /api/products/:id` - Eliminar producto (vendor)

**Carrito:**
- `GET /api/cart` - Obtener carrito
- `POST /api/cart/add` - Agregar item
- `PUT /api/cart/:id` - Actualizar cantidad
- `DELETE /api/cart/:id` - Remover item

**√ìrdenes:**
- `GET /api/orders` - Listar √≥rdenes (user/vendor)
- `GET /api/orders/:id` - Detalle de orden
- `POST /api/orders` - Crear orden
- `PUT /api/orders/:id/status` - Actualizar estado (vendor)

**Pagos:**
- `POST /api/payments/create-intent` - Crear Payment Intent
- `POST /api/webhooks/stripe` - Webhook de Stripe

**Notificaciones:**
- `GET /api/notifications` - Listar notificaciones
- `PUT /api/notifications/:id/read` - Marcar como le√≠da

### D. Variables de Entorno Requeridas

```bash
# Database
DATABASE_URL="postgresql://..."

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key"

# Google OAuth (opcional)
GOOGLE_CLIENT_ID="..."
GOOGLE_CLIENT_SECRET="..."

# Stripe (LIVE - Producci√≥n)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_live_..."
STRIPE_SECRET_KEY="sk_live_..."
STRIPE_WEBHOOK_SECRET="whsec_..."

# Algolia (opcional)
ALGOLIA_APP_ID="..."
ALGOLIA_API_KEY="..."
```

### E. Documentos Relacionados

- ‚úÖ `README.md` - Setup y getting started
- ‚úÖ `ARCHITECTURE.md` - Arquitectura t√©cnica
- ‚úÖ `FRONTEND_ARCHITECTURE.md` - Arquitectura frontend
- ‚úÖ `STRIPE_SETUP.md` - Configuraci√≥n de Stripe
- ‚úÖ `README.testing.md` - Gu√≠a de testing
- ‚úÖ `PRD.md` - Este documento
- ‚è≥ `API_DOCUMENTATION.md` - Documentaci√≥n de API (pendiente)
- ‚è≥ `DEPLOYMENT_GUIDE.md` - Gu√≠a de deployment (pendiente)

---

## 14. Historial de Cambios

| Versi√≥n | Fecha | Autor | Cambios |
|---------|-------|-------|---------|
| 1.0 | Oct 2025 | Product Team | Versi√≥n inicial del PRD |

---

## 15. Aprobaciones

| Rol | Nombre | Firma | Fecha |
|-----|--------|-------|-------|
| Product Owner | [Tu nombre] | _______ | ______ |
| Tech Lead | [Tu nombre] | _______ | ______ |
| Stakeholder | __________ | _______ | ______ |

---

**Fin del Documento**

*Este PRD es un documento vivo y se actualizar√° seg√∫n evolucione el producto.*
